Obtained from the angr project, issue #148
https://github.com/angr/angr/issues/148
